<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Email Copy Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .icon-mail {
            display: inline-block;
            padding: 10px 20px;
            background: #cabcab;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .icon-mail:hover {
            background: #b5a89b;
        }
        
        #debug-log {
            background: white;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        /* Toast Notification */
        #clipboard-toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translate(-50%, 100px);
            z-index: 9999;
            background-color: #333;
            color: #fff;
            padding: 12px 24px;
            border-radius: 8px;
            font-family: Arial, sans-serif;
            font-size: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        #clipboard-toast.visible {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, 0);
        }
    </style>
</head>
<body>
    <h1>Email Copy Functionality Test</h1>
    
    <div class="test-section">
        <h2>Test 1: Basic Click Test</h2>
        <p>Click this button:</p>
        <a href="#" id="copy-email-button" class="icon-mail">
            ðŸ“§ Copy Email
        </a>
        <input type="hidden" id="myEmail" value="bwtannenbaum77@gmail.com">
    </div>
    
    <div class="test-section">
        <h2>Test 2: Manual Trigger</h2>
        <button onclick="testClipboard()">Test Clipboard Directly</button>
        <button onclick="testJQuery()">Test jQuery Selector</button>
    </div>
    
    <div id="debug-log">
        <strong>Debug Log:</strong><br>
        <span id="log-content">Waiting for interaction...</span>
    </div>

    <!-- Load jQuery -->
    <script src="js/jquery.min.js"></script>
    
    <script>
        // Debug logging
        function log(message) {
            const logContent = document.getElementById('log-content');
            const timestamp = new Date().toLocaleTimeString();
            logContent.innerHTML += `<br>[${timestamp}] ${message}`;
        }
        
        // Test clipboard directly
        function testClipboard() {
            log('Testing clipboard API...');
            if (navigator.clipboard) {
                log('âœ“ Clipboard API is available');
                navigator.clipboard.writeText('test@example.com').then(function() {
                    log('âœ“ Successfully wrote to clipboard');
                    alert('Clipboard test successful!');
                }).catch(function(err) {
                    log('âœ— Clipboard write failed: ' + err.message);
                    alert('Clipboard test failed: ' + err.message);
                });
            } else {
                log('âœ— Clipboard API not available');
                alert('Clipboard API not available');
            }
        }
        
        // Test jQuery
        function testJQuery() {
            log('Testing jQuery...');
            log('typeof jQuery: ' + typeof jQuery);
            log('typeof $: ' + typeof $);
            
            const button = $('#copy-email-button');
            log('Button found: ' + (button.length > 0));
            log('Button length: ' + button.length);
            
            const emailInput = $('#myEmail');
            log('Email input found: ' + (emailInput.length > 0));
            log('Email value: ' + emailInput.val());
        }
        
        // Main implementation
        $(function() {
            log('Document ready fired');
            log('jQuery version: ' + $.fn.jquery);
            
            const button = $('#copy-email-button');
            log('Looking for button... found: ' + (button.length > 0));
            
            if (button.length === 0) {
                log('ERROR: Button not found!');
                return;
            }
            
            log('Attaching click handler...');
            
            button.on('click', function(event) {
                log('CLICK EVENT FIRED!');
                event.preventDefault();
                
                const emailText = $('#myEmail').val();
                log('Email to copy: ' + emailText);
                
                if (!navigator.clipboard) {
                    log('ERROR: Clipboard API not available');
                    alert('Clipboard not supported. Email: ' + emailText);
                    return;
                }
                
                log('Attempting to copy...');
                
                navigator.clipboard.writeText(emailText).then(function() {
                    log('âœ“ Copy successful!');
                    
                    // Remove existing toast
                    $('#clipboard-toast').remove();
                    log('Removed old toast');
                    
                    // Create new toast
                    $('body').append('<div id="clipboard-toast">Email copied to clipboard! ðŸ“‹</div>');
                    log('Created new toast');
                    
                    // Show toast
                    setTimeout(function() {
                        $('#clipboard-toast').addClass('visible');
                        log('Toast visible');
                    }, 100);
                    
                    // Hide toast
                    setTimeout(function() {
                        $('#clipboard-toast').removeClass('visible');
                        log('Toast hidden');
                        setTimeout(function() {
                            $('#clipboard-toast').remove();
                            log('Toast removed');
                        }, 500);
                    }, 3000);
                    
                }).catch(function(err) {
                    log('âœ— Copy failed: ' + err.message);
                    console.error('Copy failed:', err);
                    alert('Failed to copy email.');
                });
            });
            
            log('Click handler attached successfully');
        });
    </script>
</body>
</html>